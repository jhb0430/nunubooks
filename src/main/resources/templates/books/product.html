<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
     layout:decorate="~{layout/default}">
     

		<section layout:fragment="contents" class="contents">
			
		
		<div class="container">
				<div class="my-4" th:with="item =${book.item[0]}">
					<div class="border-bottom">
						<h3 class="font-weight-bold" th:utext="${item.title}">책 제목</h3>
						<span th:text="${item.author}" class="font-weight-bold">김솨솨(지은이)</span>
						<span th:text="${item.publisher}">어쩌구출판</span>
						<span th:text="${item.pubDate}">2025-01-01</span>
						
					</div>
					
					<div class="d-flex my-4"> <!--  커버, 가격정보 flex -->
						<div class="mt-3 mx-3 bg-info"><!-- 책 커버 이미지 -->
							<img alt="책 제목 표지" th:src="${item.cover}" class="book-image">
						</div>
						<div class="mt-3 mx-3"> <!--  책정보 -->
							<table class="table table-borderless">
							<tr>
								<th>가격</th>
								<td>
									<div class="d-flex align-items-center"> <!--  가격정보 -->
										<h3 class="font-weight-bold mx-2" th:text="|${#numbers.formatInteger(item.priceSales, 3, 'COMMA')} 원|">13,500원</h3>
										<del><h6 th:text="|${#numbers.formatInteger(item.priceStandard, 3, 'COMMA')} 원|">18,000원</h6></del>
										<h5 class="menu-text font-weight-bold mx-2">(10%)</h5>
									</div> 
								</td>
							</tr>
							<tr>
								<th>배송안내</th>
								<td>
									<h6>도서 포함 15,000원 이상 무료배송</h6>
									<h6>지금 주문하면 내일 도착</h6>
								</td>
							</tr>
							<tr>
								<th></th>
								<td>
									<button type="button" class="btn btn-outline-dark cartBtn" th:data-item-id="${item.itemId}">장바구니 추가</button>
								</td>
							</tr>
							</table>
						</div> 
					</div><!--  커버, 가격정보 flex -->
					
					
					<!--  책정보 -->
					
						<div class=" ml-3">
<!--					<div class="my-4"> 
							<div>
								작가 소개
							</div>
							<div>
								출판사 소개
							</div>
							<div>
								목차
							</div>
							<div>
								어쩌구저쩌구 
							</div> 				-->
						</div>
						<div class="my-4 ml-3">
						 	<h4 class="mb-3 ">기본 정보</h4>
							<table class="table">
								<tr>
									<th> 
										ISBN
									</th>
									<td th:text="${item.isbn13}"> 
										1234145
									</td>
								</tr>
								<tr>
									<th>
								 		쪽수
									</th>
									<td th:text="|${item.subInfo.itemPage} page|"> 
										104쪽
									</td>
								</tr>
								<tr>
									<th>
								 		크기	
									</th>
									<td> 
										<span th:text="${item.subInfo.packing.sizeWidth}">가로</span>
											<span class="mx-1 align-middle"> * </span>
										<span th:text="${item.subInfo.packing.sizeHeight}">세로</span>
											<span class="mx-1 align-middle"> * </span>
										<span th:text="|${item.subInfo.packing.sizeDepth} mm|">두께</span>
											<span class="mx-1 align-middle"> / </span>
										<span th:text="|${item.subInfo.packing.weight} g|">무게</span>
									</td>
								</tr>
								<tr>
									<th>
								 		제품구성		
									</th>
									<td> 
										<span th:text="${item.subInfo.packing.styleDesc}">단행본</span>
									</td>
								</tr>
							</table>
						</div>
					</div>
					
					
				</div>
			</div>
	
			
		</section>

<script layout:fragment="script">

$(document).ready(function(){

	$(".cartBtn").on("click",function(){
		let itemId = $(this).data("item-id");
		// let userId = null; client를 구분하기 위한 값은 서버에서 처리한다고 생각해주기.
        let quantity = 1;

//	alert(itemId);
// 로그인 안해도 장바구니에 저장될 수 있도록         
        
			$.ajax({
	
				type:"post"
				,url:"/cart/add"
				,data:{"itemId":itemId,"quantity":quantity}
				,success:function(response){
	
					if(response.result =="success"){
						alert("담기 성공!");
					} else {
						alert("담기 실패")
					}
				}
				,error:function(){
					alert("오류!!")
				}
			});
		
	
		});
	




});

</script>

</html>