<!DOCTYPE html>
<html lang="ko" 
    xmlns:th="http://www.thymeleaf.org" 
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
     layout:decorate="~{layout/default}">
     

		<section layout:fragment="contents" class="contents ">
		
		<!--  리스트 테스트 후 수정예정 -->
		
		<div>
		<!-- 
		<div class="d-flex" th:each="search : ${total}">
			<h6>전체</h6>
			<h6 th:text="${search.totalResults}">00건</h6>
		</div>
		 -->
		 <div class="d-flex align-items-center justify-content-between mx-3 mt-3">
			 <div class="d-flex">
				<div class="mr-2" th:if="${books.query !=null}" th:text="|' ${books.query} ' 검색 결과|">'검색어' 검색 결과  </div>
				<h5 class="font-weight-bold mr-2">전체</h5>
				<h5 class="text-success font-weight-bold" th:text="|${books.totalResults} 건|">00건</h5>
			 </div>
			 
			<div class="d-flex align-items-center justify-content-end my-3">
				<!--  <h6><input type="checkbox"> 전체선택</h6>  체크박스 -->
				<select class="form-control col-4 mr-2">
					<option selected>10개씩 보기</option>
					<option selected>20개씩 보기</option>
					<option>50개씩 보기</option>
					<option>100개씩 보기</option>
				</select>
				<button type="button" class="btn btn-light btn-outline-secondary mx-2" id="allSelectBtn">전체선택</button>
				<button type="button" class="btn btn-light btn-outline-secondary mx-2 cartBtn">장바구니</button>
				<button type="button" class="btn btn-light btn-outline-secondary mx-2"><i class="bi bi-heart"></i></button>
			</div>
		</div>
		<!-- 
			<div class="d-flex align-items-center book-info p-2 m-3 justify-content-center"  th:if="${books.query == null}" >
				<div class="h4 font-weight-bold font-italic"> 검색어를 입력해주세요
			</div>
		 -->
			
			<div class="d-flex align-items-center book-info p-2 border m-3" th:each="book : ${books.item}">
				<div class="mx-3 info-checkbox">
				<label>
					<input type="checkbox" th:value="${book.itemId}" class="item-checkbox">
				</label>
				</div>
				<img th:src="${book.cover}" class="info-img">
				<div class="mx-3 info-title">
					<h5 class="font-weight-bold" th:text="${book.title}">책 제목 어쩌구저쩌구</h5>
					<h6 th:text="|${book.author}|">저자</h6>
					<div class="d-flex align-items-center">
						<h6 th:text="${book.publisher}">출판사</h6>
						<h6 class= "ml-3" th:text="${book.pubDate}">출판일</h6>
					</div>
				</div>
				<div class="mx-3 info-price">
					<!-- 
					<h6 class="text-success" th:text="|${book.salesPoint} %|">(10%)</h6> 
					 -->
					<del><span th:text="|${#numbers.formatInteger(book.priceStandard, 3, 'COMMA')} 원|">정가 </span></del>
					<span class="font-weight-bold text-primary ml-1" th:text="|${#numbers.formatInteger(book.priceSales, 3, 'COMMA')} 원|">할인가</span>
					<div class="font-weight-bold text-info ml-1 text-small" th:text="|(${#numbers.formatInteger(book.mileage, 3, 'COMMA')} point)|">포인트</div>
				</div>
				
				
				<div class="info-cart">
					<div class="text-center my-3">
						<button type="button" class="btn btn-outline-secondary cartBtn">장바구니</button>
					</div>
					<div class="text-center my-3">
						<button type="button" class="btn btn-outline-secondary">바로구매</button>
					</div>
				</div>
				
									
			</div>
		
		<!--  페이지 넘버 -->
			<div class="d-flex align-items-center justify-content-center">
				<div class="pageNum-now">1</div>
				<div class="pageNum">2</div>
				<div class="pageNum">3</div>
				<div><i class="bi bi-three-dots text-secondary"></i></div>
				<div class="pageNum">10</div>
			</div>
		</div>
		
		
		</section>

<script layout:fragment="script">

	$(document).ready(function(){
	
		$(".cartBtn").on("click",function(){
		let itemId = $(".item-checkbox").val();
		let userId = null; 
        let quantity = 1;

// 로그인 안해도 장바구니에 저장될 수 있도록         
        
		$.ajax({

			type:"post"
			,url:"/cart/add"
			,data:{"itemId":itemId,"userId":userId, "quantity":quantity}
			,success:function(response){

				if(response.result =="success"){
					alert("담기 성공!");
				} else {
					alert("담기 실패")
				}
			}
			,error:function(){
				alert("오류!!")
			}
		});
		
		});
	
		
	});


</script>

</html>